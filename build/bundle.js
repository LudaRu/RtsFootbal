(function () {
  'use strict';

  const CFG = {
    idSelector: 'cnvGame',
    // Размер канваса
    width: 1000,
    height: 700,
    // Размер ячеек
    cellWidth: 100,
    cellHeight: 100,
    MAX_COL: 10,
    MAX_ROW: 7,
  };

  class Unit {
    constructor(name, cell) {
      this.name = name;
      /** @type Cell */
      this.setPositionByCell(cell);
      this.img =new Image();
      this.img.src = 'https://banner2.kisspng.com/20180713/xkr/kisspng-team-sport-football-player-lucas-hernandez-5b49736c91ec10.8388072915315403325977.jpg';
    }

    setPositionByCell(cell) {
      this.x = cell.top + CFG.cellWidth / 4;
      this.y = cell.left + CFG.cellWidth / 4;
      this.w = CFG.cellWidth / 2;
      this.h = CFG.cellHeight / 2;
      this.context = cell.context;
    }

    render() {
      this._renderImg();
    }

    _renderImg() {
      if(!this.img.onload){
        this.img.onload = () => {
          this.context.drawImage(this.img, this.x, this.y, this.w, this.h);
        };
      }

      this.context.drawImage(this.img, this.x, this.y, this.w, this.h);
    }
  }

  class Cell {
    constructor(colI, rowI, solid, context) {
      // Индексы в массиве объектов
      this.id = rowI + '' + colI;
      this.rowIndex = rowI;
      this.colIndex = colI;
      this.context = context;

      this.top = colI * CFG.cellWidth; // Позиция x
      this.left = rowI * CFG.cellHeight; // Позиция y
      this.solid = solid; // Выделение ячейки

      // fixme
      this.data = {};
      this.state = {};
      this.state.change = false;
    }

    toggle() {
      this.solid = !this.solid;
      this.render();
    }

    change() {
      this.render(true);
    }

    render(solid = null) {
      this.context.fillStyle = solid ? '#63e269' : '#4CAF50';
      this.context.fillRect(this.top, this.left, CFG.cellWidth, CFG.cellHeight);
      this._drawBorder();
      this.renderData();
    }

    renderData() {
      if(this.data.unit){
        this.data.unit.render();
      }
    }

    _drawBorder() {
      this.context.beginPath();
      this.context.strokeStyle = this.solid ? '#41b241' : '#44a147';
      this.context.moveTo(this.top - 0.5, this.left - 0.5);
      this.context.lineTo(this.top - 0.5, this.left + 100 - 0.5);
      this.context.lineTo(this.top + 100 - 0.5, this.left + 100 - 0.5);
      this.context.lineTo(this.top + 100 - 0.5, this.left - 0.5);
      this.context.lineTo(this.top - 0.5, this.left - 0.5);
      this.context.stroke();
    }

    createAddUnit(name) {
      this.data.unit = new Unit(name, this);
      this.renderData();
    }

    set unit(unit) {
      this.data.unit = unit;
    }

    get unit() {
      return this.data.unit;
    }

    static movementElementToCell(fromCell, toCell, nameElement) {
      if(fromCell.id !== toCell.id){
        toCell.data[nameElement] = fromCell.data[nameElement];
        toCell.data[nameElement].setPositionByCell(toCell);
        delete fromCell.data[nameElement];

        fromCell.render();
        toCell.render();
      }
    }
  }

  class Map {
    constructor() {
      this.canvas = Map._drawHtml();
      this.context = this.canvas.getContext('2d');
      this.cellList = this._generateCells();
    }

    static _drawHtml() {
      const canvas = document.createElement('canvas');
      canvas.id = CFG.idSelector;
      canvas.width = CFG.width;
      canvas.height = CFG.height;
      document.body.appendChild(canvas);

      return canvas;
    }

    render() {
      // Рендер всех ячеек
      this.cellList.forEach((items) => {
        items.forEach((cell) => {
          cell.render();
        });
      });
    }

    // Создание 2-х мерной карты с ячейками
    _generateCells() {
      const cellList = [];
      for (let row = 0; row < CFG.MAX_ROW; row++) {
        cellList[row] = [];
        for (let col = 0; col < CFG.MAX_COL; col++) {
          cellList[row][col] = new Cell(col, row, false, this.context);
        }
      }

      return cellList;
    }

    /* Найти объекта канваса по X Y курсора*/
    getCanvasCellByPosition(row, col) {
      return this.cellList[row][col];
    }

  }

  var bresenhame = (x1, y1, x2, y2) => {
    const deltaX = Math.abs(x2 - x1),
      deltaY = Math.abs(y2 - y1),
      signX = x1 < x2 ? 1 : -1,
      signY = y1 < y2 ? 1 : -1,
      points = [];

    let error = deltaX - deltaY;

    while (x1 !== x2 || y1 !== y2) {
      points.push({x: x1, y: y1});
      const error2 = error * 2;
      if (error2 > -deltaY) {
        error -= deltaY;
        x1 += signX;
      }
      if (error2 < deltaX) {
        error += deltaX;
        y1 += signY;
      }
    }
    points.push({x: x2, y: y2});

    return points;
  };

  var gameModule = (params) => {
    const mapGame = new Map();
    mapGame.render();

    /** @type Cell */
    let selectCell;
    let mouseCellId;

    mapGame.canvas.addEventListener('mousedown', (event) => {
      /** @type Cell */
      const cell = getCellByMouseEvent(event);

      if (selectCell) { // есть выбранная ячейка
        Cell.movementElementToCell(selectCell, cell, 'unit');
        selectCell = null;
        mapGame.render();
        cell.change();
      } else { // выбрана ячейка
        if (typeof cell.data.unit !== 'undefined') {
          cell.change();
          selectCell = cell;
        }
      }
    });

    mapGame.canvas.addEventListener('mousemove', (event) => {
      /** @type Cell */
      const cell = getCellByMouseEvent(event);

      if (selectCell) {
        if (mouseCellId !== cell.id) {
          mouseCellId = cell.id;
          const cellPoints = bresenhame(selectCell.colIndex, selectCell.rowIndex, cell.colIndex, cell.rowIndex);
          mapGame.render();
          cellPoints.forEach((point) => {
            const cellTemp = mapGame.cellList[point.y][point.x];
            cellTemp.change();
          });
        }
      }

      if(!selectCell) {
        if (mouseCellId !== cell.id) {
          mapGame.render();
          mouseCellId = cell.id;

          cell.change();
        }
      }

    });

    // EventEmitter.subscribe('selectCell', (data) => {
    //   selectCell = data;
    // });

    // Добавим юнита на поле
    /** @type Cell */
    const cell = mapGame.cellList[2][2];
    cell.createAddUnit('Ivan');

    function getCellByMouseEvent(event) {
      const x = event.offsetX === undefined ? event.layerX : event.offsetX;
      const y = event.offsetY === undefined ? event.layerY : event.offsetY;

      const col = Math.floor(x / CFG.cellWidth);
      const row = Math.floor(y / CFG.cellHeight);
      return mapGame.getCanvasCellByPosition(row, col);
    }

  };

  gameModule();

}());
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlcyI6WyIuLi9jbGllbnQvbW9kdWxlcy9nYW1lL2NmZy5qcyIsIi4uL2NsaWVudC9tb2R1bGVzL2dhbWUvY29tcG9uZW50cy91bml0LmpzIiwiLi4vY2xpZW50L21vZHVsZXMvZ2FtZS9jb21wb25lbnRzL0NlbGwuanMiLCIuLi9jbGllbnQvbW9kdWxlcy9nYW1lL2NvbXBvbmVudHMvbWFwLmpzIiwiLi4vY29tbW9uL2JyZXNlbmhhbWUuanMiLCIuLi9jbGllbnQvbW9kdWxlcy9nYW1lL2dhbWUuanMiLCIuLi9jbGllbnQvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IENGRyA9IHtcclxuICBpZFNlbGVjdG9yOiAnY252R2FtZScsXHJcbiAgLy8g0KDQsNC30LzQtdGAINC60LDQvdCy0LDRgdCwXHJcbiAgd2lkdGg6IDEwMDAsXHJcbiAgaGVpZ2h0OiA3MDAsXHJcbiAgLy8g0KDQsNC30LzQtdGAINGP0YfQtdC10LpcclxuICBjZWxsV2lkdGg6IDEwMCxcclxuICBjZWxsSGVpZ2h0OiAxMDAsXHJcbiAgTUFYX0NPTDogMTAsXHJcbiAgTUFYX1JPVzogNyxcclxufTsiLCJpbXBvcnQge0NGR30gZnJvbSAnLi4vY2ZnJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFVuaXQge1xyXG4gIGNvbnN0cnVjdG9yKG5hbWUsIGNlbGwpIHtcclxuICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbiAgICAvKiogQHR5cGUgQ2VsbCAqL1xyXG4gICAgdGhpcy5zZXRQb3NpdGlvbkJ5Q2VsbChjZWxsKTtcclxuICAgIHRoaXMuaW1nID1uZXcgSW1hZ2UoKTtcclxuICAgIHRoaXMuaW1nLnNyYyA9ICdodHRwczovL2Jhbm5lcjIua2lzc3BuZy5jb20vMjAxODA3MTMveGtyL2tpc3NwbmctdGVhbS1zcG9ydC1mb290YmFsbC1wbGF5ZXItbHVjYXMtaGVybmFuZGV6LTViNDk3MzZjOTFlYzEwLjgzODgwNzI5MTUzMTU0MDMzMjU5NzcuanBnJztcclxuICB9XHJcblxyXG4gIHNldFBvc2l0aW9uQnlDZWxsKGNlbGwpIHtcclxuICAgIHRoaXMueCA9IGNlbGwudG9wICsgQ0ZHLmNlbGxXaWR0aCAvIDQ7XHJcbiAgICB0aGlzLnkgPSBjZWxsLmxlZnQgKyBDRkcuY2VsbFdpZHRoIC8gNDtcclxuICAgIHRoaXMudyA9IENGRy5jZWxsV2lkdGggLyAyO1xyXG4gICAgdGhpcy5oID0gQ0ZHLmNlbGxIZWlnaHQgLyAyO1xyXG4gICAgdGhpcy5jb250ZXh0ID0gY2VsbC5jb250ZXh0O1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyKCkge1xyXG4gICAgdGhpcy5fcmVuZGVySW1nKCk7XHJcbiAgfVxyXG5cclxuICBfcmVuZGVySW1nKCkge1xyXG4gICAgaWYoIXRoaXMuaW1nLm9ubG9hZCl7XHJcbiAgICAgIHRoaXMuaW1nLm9ubG9hZCA9ICgpID0+IHtcclxuICAgICAgICB0aGlzLmNvbnRleHQuZHJhd0ltYWdlKHRoaXMuaW1nLCB0aGlzLngsIHRoaXMueSwgdGhpcy53LCB0aGlzLmgpO1xyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuY29udGV4dC5kcmF3SW1hZ2UodGhpcy5pbWcsIHRoaXMueCwgdGhpcy55LCB0aGlzLncsIHRoaXMuaCk7XHJcbiAgfVxyXG59IiwiaW1wb3J0IHtDRkd9IGZyb20gJy4uL2NmZyc7XHJcbmltcG9ydCBVbml0IGZyb20gJy4vdW5pdCc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDZWxsIHtcclxuICBjb25zdHJ1Y3Rvcihjb2xJLCByb3dJLCBzb2xpZCwgY29udGV4dCkge1xyXG4gICAgLy8g0JjQvdC00LXQutGB0Ysg0LIg0LzQsNGB0YHQuNCy0LUg0L7QsdGK0LXQutGC0L7QslxyXG4gICAgdGhpcy5pZCA9IHJvd0kgKyAnJyArIGNvbEk7XHJcbiAgICB0aGlzLnJvd0luZGV4ID0gcm93STtcclxuICAgIHRoaXMuY29sSW5kZXggPSBjb2xJO1xyXG4gICAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcclxuXHJcbiAgICB0aGlzLnRvcCA9IGNvbEkgKiBDRkcuY2VsbFdpZHRoOyAvLyDQn9C+0LfQuNGG0LjRjyB4XHJcbiAgICB0aGlzLmxlZnQgPSByb3dJICogQ0ZHLmNlbGxIZWlnaHQ7IC8vINCf0L7Qt9C40YbQuNGPIHlcclxuICAgIHRoaXMuc29saWQgPSBzb2xpZDsgLy8g0JLRi9C00LXQu9C10L3QuNC1INGP0YfQtdC50LrQuFxyXG5cclxuICAgIC8vIGZpeG1lXHJcbiAgICB0aGlzLmRhdGEgPSB7fTtcclxuICAgIHRoaXMuc3RhdGUgPSB7fTtcclxuICAgIHRoaXMuc3RhdGUuY2hhbmdlID0gZmFsc2U7XHJcbiAgfVxyXG5cclxuICB0b2dnbGUoKSB7XHJcbiAgICB0aGlzLnNvbGlkID0gIXRoaXMuc29saWQ7XHJcbiAgICB0aGlzLnJlbmRlcigpO1xyXG4gIH1cclxuXHJcbiAgY2hhbmdlKCkge1xyXG4gICAgdGhpcy5yZW5kZXIodHJ1ZSk7XHJcbiAgfVxyXG5cclxuICByZW5kZXIoc29saWQgPSBudWxsKSB7XHJcbiAgICB0aGlzLmNvbnRleHQuZmlsbFN0eWxlID0gc29saWQgPyAnIzYzZTI2OScgOiAnIzRDQUY1MCc7XHJcbiAgICB0aGlzLmNvbnRleHQuZmlsbFJlY3QodGhpcy50b3AsIHRoaXMubGVmdCwgQ0ZHLmNlbGxXaWR0aCwgQ0ZHLmNlbGxIZWlnaHQpO1xyXG4gICAgdGhpcy5fZHJhd0JvcmRlcigpO1xyXG4gICAgdGhpcy5yZW5kZXJEYXRhKCk7XHJcbiAgfVxyXG5cclxuICByZW5kZXJEYXRhKCkge1xyXG4gICAgaWYodGhpcy5kYXRhLnVuaXQpe1xyXG4gICAgICB0aGlzLmRhdGEudW5pdC5yZW5kZXIoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9kcmF3Qm9yZGVyKCkge1xyXG4gICAgdGhpcy5jb250ZXh0LmJlZ2luUGF0aCgpO1xyXG4gICAgdGhpcy5jb250ZXh0LnN0cm9rZVN0eWxlID0gdGhpcy5zb2xpZCA/ICcjNDFiMjQxJyA6ICcjNDRhMTQ3JztcclxuICAgIHRoaXMuY29udGV4dC5tb3ZlVG8odGhpcy50b3AgLSAwLjUsIHRoaXMubGVmdCAtIDAuNSk7XHJcbiAgICB0aGlzLmNvbnRleHQubGluZVRvKHRoaXMudG9wIC0gMC41LCB0aGlzLmxlZnQgKyAxMDAgLSAwLjUpO1xyXG4gICAgdGhpcy5jb250ZXh0LmxpbmVUbyh0aGlzLnRvcCArIDEwMCAtIDAuNSwgdGhpcy5sZWZ0ICsgMTAwIC0gMC41KTtcclxuICAgIHRoaXMuY29udGV4dC5saW5lVG8odGhpcy50b3AgKyAxMDAgLSAwLjUsIHRoaXMubGVmdCAtIDAuNSk7XHJcbiAgICB0aGlzLmNvbnRleHQubGluZVRvKHRoaXMudG9wIC0gMC41LCB0aGlzLmxlZnQgLSAwLjUpO1xyXG4gICAgdGhpcy5jb250ZXh0LnN0cm9rZSgpO1xyXG4gIH1cclxuXHJcbiAgY3JlYXRlQWRkVW5pdChuYW1lKSB7XHJcbiAgICB0aGlzLmRhdGEudW5pdCA9IG5ldyBVbml0KG5hbWUsIHRoaXMpO1xyXG4gICAgdGhpcy5yZW5kZXJEYXRhKCk7XHJcbiAgfVxyXG5cclxuICBzZXQgdW5pdCh1bml0KSB7XHJcbiAgICB0aGlzLmRhdGEudW5pdCA9IHVuaXQ7XHJcbiAgfVxyXG5cclxuICBnZXQgdW5pdCgpIHtcclxuICAgIHJldHVybiB0aGlzLmRhdGEudW5pdDtcclxuICB9XHJcblxyXG4gIHN0YXRpYyBtb3ZlbWVudEVsZW1lbnRUb0NlbGwoZnJvbUNlbGwsIHRvQ2VsbCwgbmFtZUVsZW1lbnQpIHtcclxuICAgIGlmKGZyb21DZWxsLmlkICE9PSB0b0NlbGwuaWQpe1xyXG4gICAgICB0b0NlbGwuZGF0YVtuYW1lRWxlbWVudF0gPSBmcm9tQ2VsbC5kYXRhW25hbWVFbGVtZW50XTtcclxuICAgICAgdG9DZWxsLmRhdGFbbmFtZUVsZW1lbnRdLnNldFBvc2l0aW9uQnlDZWxsKHRvQ2VsbCk7XHJcbiAgICAgIGRlbGV0ZSBmcm9tQ2VsbC5kYXRhW25hbWVFbGVtZW50XTtcclxuXHJcbiAgICAgIGZyb21DZWxsLnJlbmRlcigpO1xyXG4gICAgICB0b0NlbGwucmVuZGVyKCk7XHJcbiAgICB9XHJcbiAgfVxyXG59IiwiaW1wb3J0IHtDRkd9IGZyb20gJy4uL2NmZyc7XHJcbmltcG9ydCBDZWxsIGZyb20gJy4vQ2VsbCc7XHJcbmltcG9ydCB7RXZlbnRFbWl0dGVyfSBmcm9tICcuLi9zZXJ2aWNlJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1hcCB7XHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICB0aGlzLmNhbnZhcyA9IE1hcC5fZHJhd0h0bWwoKTtcclxuICAgIHRoaXMuY29udGV4dCA9IHRoaXMuY2FudmFzLmdldENvbnRleHQoJzJkJyk7XHJcbiAgICB0aGlzLmNlbGxMaXN0ID0gdGhpcy5fZ2VuZXJhdGVDZWxscygpO1xyXG4gIH1cclxuXHJcbiAgc3RhdGljIF9kcmF3SHRtbCgpIHtcclxuICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xyXG4gICAgY2FudmFzLmlkID0gQ0ZHLmlkU2VsZWN0b3I7XHJcbiAgICBjYW52YXMud2lkdGggPSBDRkcud2lkdGg7XHJcbiAgICBjYW52YXMuaGVpZ2h0ID0gQ0ZHLmhlaWdodDtcclxuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY2FudmFzKTtcclxuXHJcbiAgICByZXR1cm4gY2FudmFzO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyKCkge1xyXG4gICAgLy8g0KDQtdC90LTQtdGAINCy0YHQtdGFINGP0YfQtdC10LpcclxuICAgIHRoaXMuY2VsbExpc3QuZm9yRWFjaCgoaXRlbXMpID0+IHtcclxuICAgICAgaXRlbXMuZm9yRWFjaCgoY2VsbCkgPT4ge1xyXG4gICAgICAgIGNlbGwucmVuZGVyKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyDQodC+0LfQtNCw0L3QuNC1IDIt0YUg0LzQtdGA0L3QvtC5INC60LDRgNGC0Ysg0YEg0Y/Rh9C10LnQutCw0LzQuFxyXG4gIF9nZW5lcmF0ZUNlbGxzKCkge1xyXG4gICAgY29uc3QgY2VsbExpc3QgPSBbXTtcclxuICAgIGZvciAobGV0IHJvdyA9IDA7IHJvdyA8IENGRy5NQVhfUk9XOyByb3crKykge1xyXG4gICAgICBjZWxsTGlzdFtyb3ddID0gW107XHJcbiAgICAgIGZvciAobGV0IGNvbCA9IDA7IGNvbCA8IENGRy5NQVhfQ09MOyBjb2wrKykge1xyXG4gICAgICAgIGNlbGxMaXN0W3Jvd11bY29sXSA9IG5ldyBDZWxsKGNvbCwgcm93LCBmYWxzZSwgdGhpcy5jb250ZXh0KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBjZWxsTGlzdDtcclxuICB9XHJcblxyXG4gIC8qINCd0LDQudGC0Lgg0L7QsdGK0LXQutGC0LAg0LrQsNC90LLQsNGB0LAg0L/QviBYIFkg0LrRg9GA0YHQvtGA0LAqL1xyXG4gIGdldENhbnZhc0NlbGxCeVBvc2l0aW9uKHJvdywgY29sKSB7XHJcbiAgICByZXR1cm4gdGhpcy5jZWxsTGlzdFtyb3ddW2NvbF07XHJcbiAgfVxyXG5cclxufSIsImV4cG9ydCBkZWZhdWx0ICh4MSwgeTEsIHgyLCB5MikgPT4ge1xyXG4gIGNvbnN0IGRlbHRhWCA9IE1hdGguYWJzKHgyIC0geDEpLFxyXG4gICAgZGVsdGFZID0gTWF0aC5hYnMoeTIgLSB5MSksXHJcbiAgICBzaWduWCA9IHgxIDwgeDIgPyAxIDogLTEsXHJcbiAgICBzaWduWSA9IHkxIDwgeTIgPyAxIDogLTEsXHJcbiAgICBwb2ludHMgPSBbXTtcclxuXHJcbiAgbGV0IGVycm9yID0gZGVsdGFYIC0gZGVsdGFZO1xyXG5cclxuICB3aGlsZSAoeDEgIT09IHgyIHx8IHkxICE9PSB5Mikge1xyXG4gICAgcG9pbnRzLnB1c2goe3g6IHgxLCB5OiB5MX0pO1xyXG4gICAgY29uc3QgZXJyb3IyID0gZXJyb3IgKiAyO1xyXG4gICAgaWYgKGVycm9yMiA+IC1kZWx0YVkpIHtcclxuICAgICAgZXJyb3IgLT0gZGVsdGFZO1xyXG4gICAgICB4MSArPSBzaWduWDtcclxuICAgIH1cclxuICAgIGlmIChlcnJvcjIgPCBkZWx0YVgpIHtcclxuICAgICAgZXJyb3IgKz0gZGVsdGFYO1xyXG4gICAgICB5MSArPSBzaWduWTtcclxuICAgIH1cclxuICB9XHJcbiAgcG9pbnRzLnB1c2goe3g6IHgyLCB5OiB5Mn0pO1xyXG5cclxuICByZXR1cm4gcG9pbnRzO1xyXG59IiwiaW1wb3J0IFVuaXQgZnJvbSAnLi9jb21wb25lbnRzL3VuaXQnO1xyXG5pbXBvcnQgTWFwIGZyb20gJy4vY29tcG9uZW50cy9tYXAnO1xyXG5pbXBvcnQgQ2VsbCBmcm9tICcuL2NvbXBvbmVudHMvQ2VsbCc7XHJcbmltcG9ydCBicmVzZW5oYW1lIGZyb20gJy4uLy4uLy4uL2NvbW1vbi9icmVzZW5oYW1lJztcclxuaW1wb3J0IHtFdmVudEVtaXR0ZXJ9IGZyb20gJy4vc2VydmljZSc7XHJcbmltcG9ydCB7Q0ZHfSBmcm9tICcuL2NmZyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCAocGFyYW1zKSA9PiB7XHJcbiAgY29uc3QgbWFwR2FtZSA9IG5ldyBNYXAoKTtcclxuICBtYXBHYW1lLnJlbmRlcigpO1xyXG5cclxuICAvKiogQHR5cGUgQ2VsbCAqL1xyXG4gIGxldCBzZWxlY3RDZWxsO1xyXG4gIGxldCBtb3VzZUNlbGxJZDtcclxuXHJcbiAgbWFwR2FtZS5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgKGV2ZW50KSA9PiB7XHJcbiAgICAvKiogQHR5cGUgQ2VsbCAqL1xyXG4gICAgY29uc3QgY2VsbCA9IGdldENlbGxCeU1vdXNlRXZlbnQoZXZlbnQpO1xyXG5cclxuICAgIGlmIChzZWxlY3RDZWxsKSB7IC8vINC10YHRgtGMINCy0YvQsdGA0LDQvdC90LDRjyDRj9GH0LXQudC60LBcclxuICAgICAgQ2VsbC5tb3ZlbWVudEVsZW1lbnRUb0NlbGwoc2VsZWN0Q2VsbCwgY2VsbCwgJ3VuaXQnKTtcclxuICAgICAgc2VsZWN0Q2VsbCA9IG51bGw7XHJcbiAgICAgIG1hcEdhbWUucmVuZGVyKCk7XHJcbiAgICAgIGNlbGwuY2hhbmdlKCk7XHJcbiAgICB9IGVsc2UgeyAvLyDQstGL0LHRgNCw0L3QsCDRj9GH0LXQudC60LBcclxuICAgICAgaWYgKHR5cGVvZiBjZWxsLmRhdGEudW5pdCAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICBjZWxsLmNoYW5nZSgpO1xyXG4gICAgICAgIHNlbGVjdENlbGwgPSBjZWxsO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIG1hcEdhbWUuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIChldmVudCkgPT4ge1xyXG4gICAgLyoqIEB0eXBlIENlbGwgKi9cclxuICAgIGNvbnN0IGNlbGwgPSBnZXRDZWxsQnlNb3VzZUV2ZW50KGV2ZW50KTtcclxuXHJcbiAgICBpZiAoc2VsZWN0Q2VsbCkge1xyXG4gICAgICBpZiAobW91c2VDZWxsSWQgIT09IGNlbGwuaWQpIHtcclxuICAgICAgICBtb3VzZUNlbGxJZCA9IGNlbGwuaWQ7XHJcbiAgICAgICAgY29uc3QgY2VsbFBvaW50cyA9IGJyZXNlbmhhbWUoc2VsZWN0Q2VsbC5jb2xJbmRleCwgc2VsZWN0Q2VsbC5yb3dJbmRleCwgY2VsbC5jb2xJbmRleCwgY2VsbC5yb3dJbmRleCk7XHJcbiAgICAgICAgbWFwR2FtZS5yZW5kZXIoKTtcclxuICAgICAgICBjZWxsUG9pbnRzLmZvckVhY2goKHBvaW50KSA9PiB7XHJcbiAgICAgICAgICBjb25zdCBjZWxsVGVtcCA9IG1hcEdhbWUuY2VsbExpc3RbcG9pbnQueV1bcG9pbnQueF07XHJcbiAgICAgICAgICBjZWxsVGVtcC5jaGFuZ2UoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmKCFzZWxlY3RDZWxsKSB7XHJcbiAgICAgIGlmIChtb3VzZUNlbGxJZCAhPT0gY2VsbC5pZCkge1xyXG4gICAgICAgIG1hcEdhbWUucmVuZGVyKCk7XHJcbiAgICAgICAgbW91c2VDZWxsSWQgPSBjZWxsLmlkO1xyXG5cclxuICAgICAgICBjZWxsLmNoYW5nZSgpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gIH0pO1xyXG5cclxuICAvLyBFdmVudEVtaXR0ZXIuc3Vic2NyaWJlKCdzZWxlY3RDZWxsJywgKGRhdGEpID0+IHtcclxuICAvLyAgIHNlbGVjdENlbGwgPSBkYXRhO1xyXG4gIC8vIH0pO1xyXG5cclxuICAvLyDQlNC+0LHQsNCy0LjQvCDRjtC90LjRgtCwINC90LAg0L/QvtC70LVcclxuICAvKiogQHR5cGUgQ2VsbCAqL1xyXG4gIGNvbnN0IGNlbGwgPSBtYXBHYW1lLmNlbGxMaXN0WzJdWzJdO1xyXG4gIGNlbGwuY3JlYXRlQWRkVW5pdCgnSXZhbicpO1xyXG5cclxuICBmdW5jdGlvbiBnZXRDZWxsQnlNb3VzZUV2ZW50KGV2ZW50KSB7XHJcbiAgICBjb25zdCB4ID0gZXZlbnQub2Zmc2V0WCA9PT0gdW5kZWZpbmVkID8gZXZlbnQubGF5ZXJYIDogZXZlbnQub2Zmc2V0WDtcclxuICAgIGNvbnN0IHkgPSBldmVudC5vZmZzZXRZID09PSB1bmRlZmluZWQgPyBldmVudC5sYXllclkgOiBldmVudC5vZmZzZXRZO1xyXG5cclxuICAgIGNvbnN0IGNvbCA9IE1hdGguZmxvb3IoeCAvIENGRy5jZWxsV2lkdGgpO1xyXG4gICAgY29uc3Qgcm93ID0gTWF0aC5mbG9vcih5IC8gQ0ZHLmNlbGxIZWlnaHQpO1xyXG4gICAgcmV0dXJuIG1hcEdhbWUuZ2V0Q2FudmFzQ2VsbEJ5UG9zaXRpb24ocm93LCBjb2wpO1xyXG4gIH1cclxuXHJcbn07IiwiaW1wb3J0IGdhbWVNb2R1bGUgZnJvbSAnLi9tb2R1bGVzL2dhbWUvZ2FtZSc7XHJcblxyXG5nYW1lTW9kdWxlKCk7Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztFQUFPLE1BQU0sR0FBRyxHQUFHO0VBQ25CLEVBQUUsVUFBVSxFQUFFLFNBQVM7RUFDdkI7RUFDQSxFQUFFLEtBQUssRUFBRSxJQUFJO0VBQ2IsRUFBRSxNQUFNLEVBQUUsR0FBRztFQUNiO0VBQ0EsRUFBRSxTQUFTLEVBQUUsR0FBRztFQUNoQixFQUFFLFVBQVUsRUFBRSxHQUFHO0VBQ2pCLEVBQUUsT0FBTyxFQUFFLEVBQUU7RUFDYixFQUFFLE9BQU8sRUFBRSxDQUFDO0VBQ1osQ0FBQzs7SUFBQyxGQ1JhLE1BQU0sSUFBSSxDQUFDO0VBQzFCLEVBQUUsV0FBVyxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUU7RUFDMUIsSUFBSSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztFQUNyQjtFQUNBLElBQUksSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxDQUFDO0VBQ2pDLElBQUksSUFBSSxDQUFDLEdBQUcsRUFBRSxJQUFJLEtBQUssRUFBRSxDQUFDO0VBQzFCLElBQUksSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLEdBQUcsdUlBQXVJLENBQUM7RUFDM0osR0FBRzs7RUFFSCxFQUFFLGlCQUFpQixDQUFDLElBQUksRUFBRTtFQUMxQixJQUFJLElBQUksQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsR0FBRyxHQUFHLENBQUMsU0FBUyxHQUFHLENBQUMsQ0FBQztFQUMxQyxJQUFJLElBQUksQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLElBQUksR0FBRyxHQUFHLENBQUMsU0FBUyxHQUFHLENBQUMsQ0FBQztFQUMzQyxJQUFJLElBQUksQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDLFNBQVMsR0FBRyxDQUFDLENBQUM7RUFDL0IsSUFBSSxJQUFJLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxVQUFVLEdBQUcsQ0FBQyxDQUFDO0VBQ2hDLElBQUksSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDO0VBQ2hDLEdBQUc7O0VBRUgsRUFBRSxNQUFNLEdBQUc7RUFDWCxJQUFJLElBQUksQ0FBQyxVQUFVLEVBQUUsQ0FBQztFQUN0QixHQUFHOztFQUVILEVBQUUsVUFBVSxHQUFHO0VBQ2YsSUFBSSxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUM7RUFDeEIsTUFBTSxJQUFJLENBQUMsR0FBRyxDQUFDLE1BQU0sR0FBRyxNQUFNO0VBQzlCLFFBQVEsSUFBSSxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7RUFDekUsT0FBTyxDQUFDO0VBQ1IsS0FBSzs7RUFFTCxJQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO0VBQ3JFLEdBQUc7RUFDSDs7R0FBQyxEQzdCYyxNQUFNLElBQUksQ0FBQztFQUMxQixFQUFFLFdBQVcsQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxPQUFPLEVBQUU7RUFDMUM7RUFDQSxJQUFJLElBQUksQ0FBQyxFQUFFLEdBQUcsSUFBSSxHQUFHLEVBQUUsR0FBRyxJQUFJLENBQUM7RUFDL0IsSUFBSSxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQztFQUN6QixJQUFJLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDO0VBQ3pCLElBQUksSUFBSSxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUM7O0VBRTNCLElBQUksSUFBSSxDQUFDLEdBQUcsR0FBRyxJQUFJLEdBQUcsR0FBRyxDQUFDLFNBQVMsQ0FBQztFQUNwQyxJQUFJLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxHQUFHLEdBQUcsQ0FBQyxVQUFVLENBQUM7RUFDdEMsSUFBSSxJQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQzs7RUFFdkI7RUFDQSxJQUFJLElBQUksQ0FBQyxJQUFJLEdBQUcsRUFBRSxDQUFDO0VBQ25CLElBQUksSUFBSSxDQUFDLEtBQUssR0FBRyxFQUFFLENBQUM7RUFDcEIsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sR0FBRyxLQUFLLENBQUM7RUFDOUIsR0FBRzs7RUFFSCxFQUFFLE1BQU0sR0FBRztFQUNYLElBQUksSUFBSSxDQUFDLEtBQUssR0FBRyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUM7RUFDN0IsSUFBSSxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7RUFDbEIsR0FBRzs7RUFFSCxFQUFFLE1BQU0sR0FBRztFQUNYLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztFQUN0QixHQUFHOztFQUVILEVBQUUsTUFBTSxDQUFDLEtBQUssR0FBRyxJQUFJLEVBQUU7RUFDdkIsSUFBSSxJQUFJLENBQUMsT0FBTyxDQUFDLFNBQVMsR0FBRyxLQUFLLEdBQUcsU0FBUyxHQUFHLFNBQVMsQ0FBQztFQUMzRCxJQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLElBQUksRUFBRSxHQUFHLENBQUMsU0FBUyxFQUFFLEdBQUcsQ0FBQyxVQUFVLENBQUMsQ0FBQztFQUM5RSxJQUFJLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztFQUN2QixJQUFJLElBQUksQ0FBQyxVQUFVLEVBQUUsQ0FBQztFQUN0QixHQUFHOztFQUVILEVBQUUsVUFBVSxHQUFHO0VBQ2YsSUFBSSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDO0VBQ3RCLE1BQU0sSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7RUFDOUIsS0FBSztFQUNMLEdBQUc7O0VBRUgsRUFBRSxXQUFXLEdBQUc7RUFDaEIsSUFBSSxJQUFJLENBQUMsT0FBTyxDQUFDLFNBQVMsRUFBRSxDQUFDO0VBQzdCLElBQUksSUFBSSxDQUFDLE9BQU8sQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLEtBQUssR0FBRyxTQUFTLEdBQUcsU0FBUyxDQUFDO0VBQ2xFLElBQUksSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsR0FBRyxHQUFHLEVBQUUsSUFBSSxDQUFDLElBQUksR0FBRyxHQUFHLENBQUMsQ0FBQztFQUN6RCxJQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLEdBQUcsR0FBRyxFQUFFLElBQUksQ0FBQyxJQUFJLEdBQUcsR0FBRyxHQUFHLEdBQUcsQ0FBQyxDQUFDO0VBQy9ELElBQUksSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsR0FBRyxHQUFHLEdBQUcsR0FBRyxFQUFFLElBQUksQ0FBQyxJQUFJLEdBQUcsR0FBRyxHQUFHLEdBQUcsQ0FBQyxDQUFDO0VBQ3JFLElBQUksSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsR0FBRyxHQUFHLEdBQUcsR0FBRyxFQUFFLElBQUksQ0FBQyxJQUFJLEdBQUcsR0FBRyxDQUFDLENBQUM7RUFDL0QsSUFBSSxJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxHQUFHLEdBQUcsRUFBRSxJQUFJLENBQUMsSUFBSSxHQUFHLEdBQUcsQ0FBQyxDQUFDO0VBQ3pELElBQUksSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLEVBQUUsQ0FBQztFQUMxQixHQUFHOztFQUVILEVBQUUsYUFBYSxDQUFDLElBQUksRUFBRTtFQUN0QixJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztFQUMxQyxJQUFJLElBQUksQ0FBQyxVQUFVLEVBQUUsQ0FBQztFQUN0QixHQUFHOztFQUVILEVBQUUsSUFBSSxJQUFJLENBQUMsSUFBSSxFQUFFO0VBQ2pCLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFD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
